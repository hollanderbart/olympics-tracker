# Dutch Olympic Tracker - Milano Cortina 2026

## Project Overview
A Next.js 14 live tracker application for monitoring Netherlands' performance at the 2026 Winter Olympics in Milano Cortina. The app provides real-time medal tallies, event schedules with live countdowns, and comprehensive Olympic data with a Dutch-language interface and distinctive orange (Oranje) branding.

**Key Features:**
- Live medal tally with 60-second auto-refresh
- Full expandable medal table for all participating countries
- Dutch event schedule with real-time countdowns
- Live event status tracking (upcoming/live/completed)
- Dutch language UI with Oranje (#FF6600) theme
- Dark mode interface with responsive design

## Tech Stack
- **Framework:** Next.js 15 with App Router
- **Language:** TypeScript (strict mode)
- **Styling:** Tailwind CSS with custom orange theme
- **Runtime:** Cloudflare Pages (static export)
- **Deployment:** Wrangler CLI for Cloudflare Pages
- **Data Fetching:** TanStack Query (React Query) with client-side fetching
- **Testing:** Jest, React Testing Library, custom fetch mocks
- **Data Source:** Direct client-side fetch from olympics.com API

## Architecture

### Directory Structure
```
/app
  /page
    page.tsx          - Main dashboard page
    page.test.tsx     - Integration tests for homepage
  layout.tsx          - Root layout with metadata and QueryProvider
  globals.css         - Global styles with Tailwind

/components
  /MedalOverview
    MedalOverview.tsx       - Dutch medal count component
    MedalOverview.test.tsx  - Component tests
    index.ts                - Barrel export
  /MedalTally
    MedalTally.tsx          - Full medal table component
    MedalTally.test.tsx     - Component tests
    index.ts                - Barrel export
  QueryProvider.tsx   - TanStack Query client provider
  Header.tsx          - App header with title and live indicator
  EventList.tsx       - Dutch events schedule with countdowns
  NextEventHighlight.tsx - Next event display
  Footer.tsx          - App footer
  utils.ts            - Component utilities (formatting, etc.)

/lib
  /olympics
    olympics.ts       - Core data fetching logic
    olympics.test.ts  - Data fetching tests
    index.ts          - Barrel export
  types.ts            - TypeScript type definitions
  constants.ts        - App constants (refresh intervals, API endpoints, icons)

/tests
  /setup
    test-utils.tsx    - Custom render with QueryClient wrapper
    /mocks
      handlers.ts     - Mock data definitions
      mockFetch.ts    - Fetch mock implementation
      server.ts       - MSW server (legacy)

/public               - Static assets
/out                  - Next.js static export output
```

### Key Files
- **lib/olympics.ts** - Central data fetching module with fallback data
- **lib/types.ts** - Type definitions for medals, events, countries
- **lib/constants.ts** - Sport icons (‚õ∏Ô∏è üèí üõ∑ üíÄ üíÉ), refresh intervals, API URLs
- **app/api/** - Edge runtime API routes with cache control headers

## Development Guidelines

### Language & Branding
- **UI Language:** All user-facing text MUST be in Dutch
- **Primary Color:** Oranje #FF6600 (Netherlands brand color)
- **Theme:** Dark mode with #0a0a12 background
- **Sport Icons:** Use emoji icons from constants.ts (‚õ∏Ô∏è ice skating, üèí hockey, üõ∑ sliding, üíÄ skeleton, üíÉ figure skating, etc.)

### React Components
- Use `'use client'` directive for all client-side components
- Implement auto-refresh with `useEffect` and intervals
- Use state management with `useState` for data and UI state
- Clean up intervals in component unmount

### TypeScript Standards
- Strict typing enabled
- Define all types in `/lib/types.ts`
- Export/import types explicitly
- Use proper type annotations for function parameters and returns

### API Routes
- Target Edge runtime: `export const runtime = 'edge'`
- Include cache control headers for performance
- Proxy olympics.com JSON endpoints
- Provide fallback data for pre-games or offline scenarios
- Handle CORS and error states gracefully

### Styling Patterns
- **Tailwind CSS** for all styling
- Custom orange colors defined in `tailwind.config.ts`:
  - `oranje-50` through `oranje-950` color scale
  - Primary: `oranje-500` (#FF6600)
- **Animations:**
  - `slide-in` - Entry animations for content
  - `pulse` - Live indicators
  - `shimmer` - Loading skeletons
- **Responsive:** Mobile-first, use Tailwind responsive prefixes (sm:, md:, lg:)
- **Dark Theme:** Dark backgrounds with light text, proper contrast

## Component Patterns

### Data Fetching Components
```typescript
'use client'
import { useState, useEffect } from 'react'

export default function Component() {
  const [data, setData] = useState<DataType | null>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    const fetchData = async () => {
      const response = await fetch('/api/endpoint')
      const result = await response.json()
      setData(result)
      setLoading(false)
    }

    fetchData()
    const interval = setInterval(fetchData, 60000) // Auto-refresh
    return () => clearInterval(interval)
  }, [])

  if (loading) return <LoadingState />
  return <div>Content</div>
}
```

### Styling Patterns
- Use `bg-oranje-500` for primary orange backgrounds
- Use `text-oranje-400` for orange text
- Implement hover states with `hover:bg-oranje-600`
- Add transitions with `transition-colors duration-200`
- Use `rounded-lg` for card borders
- Apply shadows with `shadow-lg`

### Animation Classes (in globals.css)
- `animate-slide-in` - Smooth entry animations
- `animate-pulse` - Live status indicators
- `animate-shimmer` - Loading state shimmer effect

## Data Flow

### API Architecture
1. **Client Components** (`/components`) fetch from local API routes
2. **API Routes** (`/app/api/`) proxy olympics.com JSON endpoints
3. **Edge Runtime** serves responses with cache headers
4. **Fallback Data** in `lib/olympics.ts` for offline/pre-games

### Auto-Refresh Intervals
- **Medal Tally:** 60 seconds (`MEDAL_REFRESH_INTERVAL`)
- **Event Schedule:** 30 seconds (`SCHEDULE_REFRESH_INTERVAL`)
- **Live Events:** 15 seconds (when events are live)

### Cache Strategy
- API routes set `Cache-Control` headers for edge caching
- Client-side intervals ensure fresh data
- Fallback data prevents empty states

### Data Sources
- **olympics.com API** - Primary data source (proxied through /app/api/)
- **Fallback data** - Hardcoded in lib/olympics.ts for testing/offline

## Testing

### Test Structure
Tests are colocated with their components following this pattern:
```
/components/MedalOverview/
  MedalOverview.tsx       - Component implementation
  MedalOverview.test.tsx  - Component tests
  index.ts                - Barrel export
```

### Running Tests
```bash
npm test              # Run all tests
npm run test:watch    # Run tests in watch mode
npm run test:coverage # Run tests with coverage report
```

### Test Setup
- **Framework:** Jest with jsdom environment
- **Testing Library:** React Testing Library
- **Query Testing:** Custom render wrapper with QueryClient
- **API Mocking:** Custom fetch mock (see `tests/setup/mocks/`)

### Writing Tests
Tests are colocated with their code for better discoverability:
- Component tests: `components/ComponentName/ComponentName.test.tsx`
- Page tests: `app/page/page.test.tsx`
- Utility tests: `lib/moduleName/moduleName.test.ts`

Example test structure:
```typescript
import { render } from '@/tests/setup/test-utils'
import ComponentName from './ComponentName'

describe('ComponentName', () => {
  it('should render correctly', () => {
    render(<ComponentName />)
    // assertions
  })
})
```

### Test Utilities
- **test-utils.tsx**: Custom render with QueryClientProvider wrapper
- **mockFetch.ts**: Fetch API mock for testing data fetching
- **handlers.ts**: Mock data definitions for olympics API

## Deployment

### Development
```bash
npm run dev          # Start Next.js dev server (http://localhost:3000)
npm run typecheck    # Run TypeScript type checking
```

### Building
```bash
npm run build        # Build static export to /out directory
```

### Deployment
```bash
# Cloudflare Pages deployment via Wrangler
wrangler pages deploy out
```

### Environment
- **Local:** Standard Next.js dev server with hot reload
- **Production:** Cloudflare Pages with static export
- **Data Fetching:** Client-side only (no server-side rendering)
- No environment variables required (public API endpoints)

## Feature Development Checklist

When adding new features, follow this checklist:

- [ ] Define TypeScript types in `/lib/types.ts`
- [ ] Add constants (refresh intervals, icons, etc.) to `/lib/constants.ts`
- [ ] Create or update components in `/components/`
- [ ] Use Dutch language for ALL user-facing strings
- [ ] After each completed task: run `git add`, create a commit, and push to `origin/main`
- [ ] Apply Oranje color scheme (bg-oranje-*, text-oranje-*)
- [ ] Add `'use client'` directive if using hooks or browser APIs
- [ ] Implement auto-refresh with appropriate intervals
- [ ] Test with Edge runtime compatibility (no Node.js APIs)
- [ ] Ensure mobile responsive design (Tailwind responsive classes)
- [ ] Add loading states with shimmer animations
- [ ] Include proper TypeScript types for all data
- [ ] Test with fallback data scenarios
- [ ] Verify dark theme appearance
- [ ] Add appropriate sport icons from constants

## Common Tasks

### Adding a New Component
1. Create file in `/components/YourComponent.tsx`
2. Add `'use client'` if using state or effects
3. Import types from `lib/types.ts`
4. Style with Tailwind + oranje colors
5. Implement responsive design
6. Add Dutch language strings

### Adding a New API Endpoint
1. Create file in `/app/api/your-endpoint/route.ts`
2. Export `runtime = 'edge'`
3. Implement GET handler with error handling
4. Add cache control headers
5. Proxy olympics.com or return fallback data
6. Test Edge runtime compatibility

### Updating Data Types
1. Update interfaces in `/lib/types.ts`
2. Update fallback data in `/lib/olympics.ts`
3. Update components consuming the data
4. Verify TypeScript compilation

## Style Guide

### Dutch Translations (Common Terms)
- Medal / Medaille
- Gold / Goud
- Silver / Zilver
- Bronze / Brons
- Live / Live
- Schedule / Programma
- Event / Evenement
- Netherlands / Nederland
- Athlete / Atleet
- Results / Resultaten

### Color Palette
- **Primary Orange:** #FF6600 (oranje-500)
- **Dark Background:** #0a0a12
- **Card Background:** #1a1a24
- **Border:** #2a2a3a
- **Text Primary:** #ffffff
- **Text Secondary:** #a0a0b0

### Spacing & Layout
- Card padding: `p-6`
- Section spacing: `space-y-6`
- Grid gaps: `gap-6`
- Rounded corners: `rounded-lg`

## Important Notes

- **Edge Runtime Only:** No Node.js APIs (fs, path, etc.) in production code
- **Client-Side Fetching:** All data fetching happens in client components
- **Dutch First:** Always use Dutch for UI, fallback to English for technical terms
- **Oranje Theme:** Orange is the brand identity - use liberally
- **Mobile-First:** Design for mobile, enhance for desktop
- **Auto-Refresh:** Keep data fresh with appropriate intervals
- **Fallback Data:** Always provide fallback for robust UX
